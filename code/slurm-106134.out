Using config:
{'B_VALIDATION': False,
 'CONFIG_NAME': 'DAMSM',
 'CUDA': False,
 'DATASET_NAME': 'face',
 'DATA_DIR': '../data/face_image',
 'GAN': {'B_ATTENTION': True,
         'B_DCGAN': False,
         'CONDITION_DIM': 100,
         'DF_DIM': 64,
         'GF_DIM': 128,
         'R_NUM': 2,
         'Z_DIM': 100},
 'GPU_ID': 0,
 'RNN_TYPE': 'LSTM',
 'TEXT': {'CAPTIONS_PER_IMAGE': 4, 'EMBEDDING_DIM': 256, 'WORDS_NUM': 18},
 'TRAIN': {'BATCH_SIZE': 100,
           'B_NET_D': True,
           'DISCRIMINATOR_LR': 0.0002,
           'ENCODER_LR': 0.0025,
           'FLAG': True,
           'GENERATOR_LR': 0.0002,
           'MAX_EPOCH': 100,
           'NET_E': '',
           'NET_G': '',
           'RNN_GRAD_CLIP': 0.25,
           'SMOOTH': {'GAMMA1': 1.0,
                      'GAMMA2': 5.0,
                      'GAMMA3': 10.0,
                      'LAMBDA': 1.0},
           'SNAPSHOT_INTERVAL': 10},
 'TREE': {'BASE_SIZE': 128, 'BRANCH_NUM': 1},
 'WORKERS': 1}
Load filenames from: ../data/face_image/train/filenames_all.pickle (6001)
Load filenames from: ../data/face_image/test/filenames_all.pickle (1000)
Load from:  ../data/face_image/captions.pickle
41 4 24004
Load filenames from: ../data/face_image/train/filenames_all.pickle (6001)
Load filenames from: ../data/face_image/test/filenames_all.pickle (1000)
Load from:  ../data/face_image/captions.pickle
Load pretrained model from  https://download.pytorch.org/models/inception_v3_google-1a9a5a14.pth
| epoch   0 |     0/   60 batches | ms/batch 108.67 | s_loss  0.02  0.02 | w_loss  0.03  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   0 | valid loss  9.06  8.91 | lr 0.00250|
------------------------------------------------------------
Save G/Ds models.
| epoch   1 |     0/   60 batches | ms/batch 123.78 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   1 | valid loss  8.67  8.46 | lr 0.00225|
------------------------------------------------------------
| epoch   2 |     0/   60 batches | ms/batch 125.50 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   2 | valid loss  8.51  8.28 | lr 0.00203|
------------------------------------------------------------
| epoch   3 |     0/   60 batches | ms/batch 121.34 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   3 | valid loss  8.33  8.13 | lr 0.00182|
------------------------------------------------------------
| epoch   4 |     0/   60 batches | ms/batch 125.16 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   4 | valid loss  8.28  8.03 | lr 0.00164|
------------------------------------------------------------
| epoch   5 |     0/   60 batches | ms/batch 124.74 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   5 | valid loss  8.21  7.91 | lr 0.00148|
------------------------------------------------------------
| epoch   6 |     0/   60 batches | ms/batch 122.19 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   6 | valid loss  8.16  8.08 | lr 0.00133|
------------------------------------------------------------
| epoch   7 |     0/   60 batches | ms/batch 123.05 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   7 | valid loss  8.15  7.87 | lr 0.00120|
------------------------------------------------------------
| epoch   8 |     0/   60 batches | ms/batch 123.17 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   8 | valid loss  8.11  7.78 | lr 0.00108|
------------------------------------------------------------
| epoch   9 |     0/   60 batches | ms/batch 126.34 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch   9 | valid loss  8.16  7.82 | lr 0.00097|
------------------------------------------------------------
| epoch  10 |     0/   60 batches | ms/batch 121.87 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  10 | valid loss  8.18  7.86 | lr 0.00087|
------------------------------------------------------------
Save G/Ds models.
| epoch  11 |     0/   60 batches | ms/batch 123.33 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  11 | valid loss  8.04  7.83 | lr 0.00078|
------------------------------------------------------------
| epoch  12 |     0/   60 batches | ms/batch 124.35 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  12 | valid loss  8.08  7.75 | lr 0.00071|
------------------------------------------------------------
| epoch  13 |     0/   60 batches | ms/batch 120.61 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  13 | valid loss  8.10  7.79 | lr 0.00064|
------------------------------------------------------------
| epoch  14 |     0/   60 batches | ms/batch 122.68 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  14 | valid loss  8.03  7.68 | lr 0.00057|
------------------------------------------------------------
| epoch  15 |     0/   60 batches | ms/batch 121.91 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  15 | valid loss  8.04  7.67 | lr 0.00051|
------------------------------------------------------------
| epoch  16 |     0/   60 batches | ms/batch 124.78 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  16 | valid loss  8.02  7.70 | lr 0.00046|
------------------------------------------------------------
| epoch  17 |     0/   60 batches | ms/batch 126.75 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  17 | valid loss  8.08  7.71 | lr 0.00042|
------------------------------------------------------------
| epoch  18 |     0/   60 batches | ms/batch 120.80 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  18 | valid loss  8.06  7.68 | lr 0.00038|
------------------------------------------------------------
| epoch  19 |     0/   60 batches | ms/batch 123.31 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  19 | valid loss  8.09  7.77 | lr 0.00034|
------------------------------------------------------------
| epoch  20 |     0/   60 batches | ms/batch 124.79 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  20 | valid loss  8.08  7.77 | lr 0.00030|
------------------------------------------------------------
Save G/Ds models.
| epoch  21 |     0/   60 batches | ms/batch 124.73 | s_loss  0.02  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  21 | valid loss  8.00  7.71 | lr 0.00027|
------------------------------------------------------------
| epoch  22 |     0/   60 batches | ms/batch 120.19 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  22 | valid loss  8.06  7.76 | lr 0.00025|
------------------------------------------------------------
| epoch  23 |     0/   60 batches | ms/batch 125.70 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  23 | valid loss  8.05  7.75 | lr 0.00025|
------------------------------------------------------------
| epoch  24 |     0/   60 batches | ms/batch 123.10 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  24 | valid loss  8.03  7.77 | lr 0.00025|
------------------------------------------------------------
| epoch  25 |     0/   60 batches | ms/batch 124.03 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  25 | valid loss  8.00  7.70 | lr 0.00025|
------------------------------------------------------------
| epoch  26 |     0/   60 batches | ms/batch 122.01 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  26 | valid loss  8.04  7.73 | lr 0.00025|
------------------------------------------------------------
| epoch  27 |     0/   60 batches | ms/batch 122.49 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  27 | valid loss  8.08  7.69 | lr 0.00025|
------------------------------------------------------------
| epoch  28 |     0/   60 batches | ms/batch 124.87 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  28 | valid loss  7.92  7.65 | lr 0.00025|
------------------------------------------------------------
| epoch  29 |     0/   60 batches | ms/batch 123.06 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  29 | valid loss  8.12  7.84 | lr 0.00025|
------------------------------------------------------------
| epoch  30 |     0/   60 batches | ms/batch 122.04 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  30 | valid loss  8.11  7.69 | lr 0.00025|
------------------------------------------------------------
Save G/Ds models.
| epoch  31 |     0/   60 batches | ms/batch 122.29 | s_loss  0.01  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  31 | valid loss  8.03  7.63 | lr 0.00025|
------------------------------------------------------------
| epoch  32 |     0/   60 batches | ms/batch 122.16 | s_loss  0.02  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  32 | valid loss  8.02  7.71 | lr 0.00025|
------------------------------------------------------------
| epoch  33 |     0/   60 batches | ms/batch 123.92 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  33 | valid loss  7.97  7.60 | lr 0.00025|
------------------------------------------------------------
| epoch  34 |     0/   60 batches | ms/batch 120.93 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  34 | valid loss  8.08  7.81 | lr 0.00025|
------------------------------------------------------------
| epoch  35 |     0/   60 batches | ms/batch 125.97 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  35 | valid loss  8.09  7.82 | lr 0.00025|
------------------------------------------------------------
| epoch  36 |     0/   60 batches | ms/batch 125.27 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  36 | valid loss  8.08  7.78 | lr 0.00025|
------------------------------------------------------------
| epoch  37 |     0/   60 batches | ms/batch 122.99 | s_loss  0.02  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  37 | valid loss  8.02  7.79 | lr 0.00025|
------------------------------------------------------------
| epoch  38 |     0/   60 batches | ms/batch 126.40 | s_loss  0.02  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  38 | valid loss  8.06  7.75 | lr 0.00025|
------------------------------------------------------------
| epoch  39 |     0/   60 batches | ms/batch 121.14 | s_loss  0.02  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  39 | valid loss  7.99  7.73 | lr 0.00025|
------------------------------------------------------------
| epoch  40 |     0/   60 batches | ms/batch 124.80 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  40 | valid loss  8.05  7.82 | lr 0.00025|
------------------------------------------------------------
Save G/Ds models.
| epoch  41 |     0/   60 batches | ms/batch 124.08 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  41 | valid loss  8.02  7.79 | lr 0.00025|
------------------------------------------------------------
| epoch  42 |     0/   60 batches | ms/batch 123.75 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  42 | valid loss  8.08  7.74 | lr 0.00025|
------------------------------------------------------------
| epoch  43 |     0/   60 batches | ms/batch 121.01 | s_loss  0.01  0.01 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  43 | valid loss  8.11  7.89 | lr 0.00025|
------------------------------------------------------------
| epoch  44 |     0/   60 batches | ms/batch 121.08 | s_loss  0.01  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  44 | valid loss  8.11  7.81 | lr 0.00025|
------------------------------------------------------------
| epoch  45 |     0/   60 batches | ms/batch 123.94 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  45 | valid loss  8.02  7.77 | lr 0.00025|
------------------------------------------------------------
| epoch  46 |     0/   60 batches | ms/batch 122.86 | s_loss  0.02  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  46 | valid loss  8.12  7.78 | lr 0.00025|
------------------------------------------------------------
| epoch  47 |     0/   60 batches | ms/batch 123.65 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  47 | valid loss  8.06  7.94 | lr 0.00025|
------------------------------------------------------------
| epoch  48 |     0/   60 batches | ms/batch 123.71 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  48 | valid loss  8.05  7.84 | lr 0.00025|
------------------------------------------------------------
| epoch  49 |     0/   60 batches | ms/batch 126.09 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  49 | valid loss  8.01  7.81 | lr 0.00025|
------------------------------------------------------------
| epoch  50 |     0/   60 batches | ms/batch 123.58 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  50 | valid loss  8.06  7.80 | lr 0.00025|
------------------------------------------------------------
Save G/Ds models.
| epoch  51 |     0/   60 batches | ms/batch 123.63 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  51 | valid loss  8.05  7.79 | lr 0.00025|
------------------------------------------------------------
| epoch  52 |     0/   60 batches | ms/batch 122.48 | s_loss  0.01  0.01 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  52 | valid loss  8.09  7.86 | lr 0.00025|
------------------------------------------------------------
| epoch  53 |     0/   60 batches | ms/batch 120.21 | s_loss  0.01  0.01 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  53 | valid loss  8.03  7.80 | lr 0.00025|
------------------------------------------------------------
| epoch  54 |     0/   60 batches | ms/batch 120.71 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  54 | valid loss  8.06  7.77 | lr 0.00025|
------------------------------------------------------------
| epoch  55 |     0/   60 batches | ms/batch 121.86 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  55 | valid loss  8.06  7.73 | lr 0.00025|
------------------------------------------------------------
| epoch  56 |     0/   60 batches | ms/batch 121.00 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  56 | valid loss  8.10  7.75 | lr 0.00025|
------------------------------------------------------------
| epoch  57 |     0/   60 batches | ms/batch 125.95 | s_loss  0.01  0.01 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  57 | valid loss  8.09  7.75 | lr 0.00025|
------------------------------------------------------------
| epoch  58 |     0/   60 batches | ms/batch 122.40 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  58 | valid loss  8.05  7.87 | lr 0.00025|
------------------------------------------------------------
| epoch  59 |     0/   60 batches | ms/batch 124.14 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  59 | valid loss  8.02  7.85 | lr 0.00025|
------------------------------------------------------------
| epoch  60 |     0/   60 batches | ms/batch 123.18 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  60 | valid loss  8.01  7.71 | lr 0.00025|
------------------------------------------------------------
Save G/Ds models.
| epoch  61 |     0/   60 batches | ms/batch 122.32 | s_loss  0.02  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  61 | valid loss  8.11  7.83 | lr 0.00025|
------------------------------------------------------------
| epoch  62 |     0/   60 batches | ms/batch 122.14 | s_loss  0.01  0.01 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  62 | valid loss  8.15  7.86 | lr 0.00025|
------------------------------------------------------------
| epoch  63 |     0/   60 batches | ms/batch 122.13 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  63 | valid loss  8.22  7.94 | lr 0.00025|
------------------------------------------------------------
| epoch  64 |     0/   60 batches | ms/batch 122.54 | s_loss  0.01  0.01 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  64 | valid loss  8.11  7.90 | lr 0.00025|
------------------------------------------------------------
| epoch  65 |     0/   60 batches | ms/batch 119.35 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  65 | valid loss  8.03  7.83 | lr 0.00025|
------------------------------------------------------------
| epoch  66 |     0/   60 batches | ms/batch 121.35 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  66 | valid loss  8.12  7.71 | lr 0.00025|
------------------------------------------------------------
| epoch  67 |     0/   60 batches | ms/batch 122.93 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  67 | valid loss  8.03  7.80 | lr 0.00025|
------------------------------------------------------------
| epoch  68 |     0/   60 batches | ms/batch 123.27 | s_loss  0.01  0.01 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  68 | valid loss  8.06  7.83 | lr 0.00025|
------------------------------------------------------------
| epoch  69 |     0/   60 batches | ms/batch 121.93 | s_loss  0.02  0.02 | w_loss  0.01  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  69 | valid loss  8.05  7.89 | lr 0.00025|
------------------------------------------------------------
| epoch  70 |     0/   60 batches | ms/batch 125.36 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  70 | valid loss  8.02  7.82 | lr 0.00025|
------------------------------------------------------------
Save G/Ds models.
| epoch  71 |     0/   60 batches | ms/batch 121.53 | s_loss  0.02  0.02 | w_loss  0.01  0.01
------------------------------------------------------------
the length of train, 60
the length of test, 10
| end epoch  71 | valid loss  8.03  7.82 | lr 0.00025|
------------------------------------------------------------
| epoch  72 |     0/   60 batches | ms/batch 121.60 | s_loss  0.02  0.02 | w_loss  0.02  0.02
------------------------------------------------------------
the length of train, 60
the length of test, 10
slurmstepd: error: *** JOB 106134 ON gpu-comp-206 CANCELLED AT 2020-07-01T18:24:49 ***
