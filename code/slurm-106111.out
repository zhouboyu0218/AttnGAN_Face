Using config:
{'B_VALIDATION': False,
 'CONFIG_NAME': 'attn2',
 'CUDA': True,
 'DATASET_NAME': 'faces',
 'DATA_DIR': '../data/face_image',
 'GAN': {'B_ATTENTION': True,
         'B_DCGAN': False,
         'CONDITION_DIM': 100,
         'DF_DIM': 64,
         'GF_DIM': 32,
         'R_NUM': 2,
         'Z_DIM': 100},
 'GPU_ID': 0,
 'RNN_TYPE': 'LSTM',
 'TEXT': {'CAPTIONS_PER_IMAGE': 4, 'EMBEDDING_DIM': 256, 'WORDS_NUM': 18},
 'TRAIN': {'BATCH_SIZE': 22,
           'B_NET_D': True,
           'DISCRIMINATOR_LR': 0.001,
           'ENCODER_LR': 0.0002,
           'FLAG': True,
           'GENERATOR_LR': 0.001,
           'MAX_EPOCH': 50,
           'NET_E': '../DAMSMencoders/face_image/text_encoder100.pth',
           'NET_G': '',
           'RNN_GRAD_CLIP': 0.25,
           'SMOOTH': {'GAMMA1': 4.0,
                      'GAMMA2': 5.0,
                      'GAMMA3': 10.0,
                      'LAMBDA': 5.0},
           'SNAPSHOT_INTERVAL': 10},
 'TREE': {'BASE_SIZE': 64, 'BRANCH_NUM': 3},
 'WORKERS': 4}
Load filenames from: ../data/face_image/train/filenames.pickle (1000)
Load filenames from: ../data/face_image/test/filenames.pickle (200)
Load from:  ../data/face_image/captions.pickle
Load pretrained model from  https://download.pytorch.org/models/inception_v3_google-1a9a5a14.pth
Load image encoder from: ../DAMSMencoders/face_image/image_encoder100.pth
Load text encoder from: ../DAMSMencoders/face_image/text_encoder100.pth
# of netsD 3
[0/50][45]
                  Loss_D: 2.86 Loss_G: 83.24 Time: 86.73s
Save G/Ds models.
[1/50][45]
                  Loss_D: 4.58 Loss_G: 63.87 Time: 37.73s
errD0: 1.32 errD1: 1.58 errD2: 0.82 
g_loss0: 3.11 g_loss1: 5.82 g_loss2: 4.21 w_loss: 31.35 s_loss: 27.14 kl_loss: 0.03 
[2/50][45]
                  Loss_D: 2.76 Loss_G: 73.45 Time: 37.79s
[3/50][45]
                  Loss_D: 2.51 Loss_G: 69.97 Time: 38.02s
errD0: 0.83 errD1: 1.69 errD2: 0.81 
g_loss0: 8.32 g_loss1: 2.85 g_loss2: 4.69 w_loss: 27.42 s_loss: 23.74 kl_loss: 0.04 
[4/50][45]
                  Loss_D: 3.04 Loss_G: 74.48 Time: 37.95s
[5/50][45]
                  Loss_D: 4.03 Loss_G: 68.19 Time: 37.87s
errD0: 0.73 errD1: 0.97 errD2: 1.45 
g_loss0: 9.44 g_loss1: 5.75 g_loss2: 4.23 w_loss: 18.89 s_loss: 23.68 kl_loss: 0.10 
[6/50][45]
                  Loss_D: 2.96 Loss_G: 55.71 Time: 38.11s
[7/50][45]
                  Loss_D: 2.76 Loss_G: 60.58 Time: 37.96s
errD0: 0.66 errD1: 0.80 errD2: 1.76 
g_loss0: 6.96 g_loss1: 5.76 g_loss2: 7.64 w_loss: 17.03 s_loss: 20.07 kl_loss: 0.25 
[8/50][45]
                  Loss_D: 3.25 Loss_G: 69.02 Time: 38.23s
[9/50][45]
                  Loss_D: 5.15 Loss_G: 50.87 Time: 38.04s
[10/50][45]
                  Loss_D: 2.31 Loss_G: 54.20 Time: 38.25s
Save G/Ds models.
errD0: 0.79 errD1: 1.17 errD2: 0.77 
g_loss0: 6.26 g_loss1: 3.37 g_loss2: 6.33 w_loss: 14.78 s_loss: 18.92 kl_loss: 0.34 
[11/50][45]
                  Loss_D: 2.35 Loss_G: 64.27 Time: 38.00s
[12/50][45]
                  Loss_D: 3.87 Loss_G: 48.27 Time: 37.92s
errD0: 0.88 errD1: 1.52 errD2: 0.77 
g_loss0: 12.74 g_loss1: 15.21 g_loss2: 6.12 w_loss: 13.21 s_loss: 18.19 kl_loss: 0.35 
[13/50][45]
                  Loss_D: 2.09 Loss_G: 63.95 Time: 38.04s
[14/50][45]
                  Loss_D: 2.58 Loss_G: 61.23 Time: 37.83s
errD0: 0.70 errD1: 0.66 errD2: 0.73 
g_loss0: 9.93 g_loss1: 8.65 g_loss2: 4.47 w_loss: 14.84 s_loss: 19.32 kl_loss: 0.30 
[15/50][45]
                  Loss_D: 2.90 Loss_G: 64.44 Time: 38.01s
[16/50][45]
                  Loss_D: 3.23 Loss_G: 66.16 Time: 37.87s
errD0: 0.82 errD1: 0.84 errD2: 0.72 
g_loss0: 9.84 g_loss1: 9.76 g_loss2: 5.86 w_loss: 13.81 s_loss: 18.52 kl_loss: 0.45 
[17/50][45]
                  Loss_D: 4.25 Loss_G: 80.17 Time: 37.95s
[18/50][45]
                  Loss_D: 2.20 Loss_G: 74.80 Time: 37.83s
errD0: 1.31 errD1: 0.85 errD2: 0.89 
g_loss0: 16.46 g_loss1: 12.49 g_loss2: 7.22 w_loss: 11.61 s_loss: 17.63 kl_loss: 0.58 
[19/50][45]
                  Loss_D: 3.05 Loss_G: 66.00 Time: 38.20s
[20/50][45]
                  Loss_D: 2.14 Loss_G: 56.24 Time: 37.97s
Save G/Ds models.
[21/50][45]
                  Loss_D: 1.89 Loss_G: 60.11 Time: 37.81s
errD0: 0.52 errD1: 0.79 errD2: 0.91 
g_loss0: 10.55 g_loss1: 12.78 g_loss2: 5.72 w_loss: 18.65 s_loss: 20.16 kl_loss: 0.67 
[22/50][45]
                  Loss_D: 3.37 Loss_G: 67.24 Time: 38.03s
[23/50][45]
                  Loss_D: 2.41 Loss_G: 65.42 Time: 37.87s
errD0: 0.65 errD1: 1.14 errD2: 0.86 
g_loss0: 12.29 g_loss1: 9.06 g_loss2: 4.56 w_loss: 14.16 s_loss: 19.24 kl_loss: 0.58 
[24/50][45]
                  Loss_D: 2.18 Loss_G: 63.96 Time: 38.14s
[25/50][45]
                  Loss_D: 3.05 Loss_G: 75.97 Time: 37.93s
errD0: 1.19 errD1: 0.90 errD2: 0.80 
g_loss0: 16.47 g_loss1: 18.88 g_loss2: 5.01 w_loss: 14.05 s_loss: 20.39 kl_loss: 0.78 
[26/50][45]
                  Loss_D: 2.03 Loss_G: 57.45 Time: 38.02s
[27/50][45]
                  Loss_D: 1.94 Loss_G: 72.45 Time: 38.04s
errD0: 0.54 errD1: 0.64 errD2: 0.92 
g_loss0: 10.33 g_loss1: 12.28 g_loss2: 5.59 w_loss: 9.51 s_loss: 16.77 kl_loss: 0.66 
[28/50][45]
                  Loss_D: 2.25 Loss_G: 65.81 Time: 38.08s
[29/50][45]
                  Loss_D: 1.99 Loss_G: 52.63 Time: 37.88s
[30/50][45]
                  Loss_D: 2.02 Loss_G: 49.20 Time: 38.06s
Save G/Ds models.
errD0: 0.72 errD1: 0.97 errD2: 0.66 
g_loss0: 10.17 g_loss1: 8.83 g_loss2: 5.17 w_loss: 12.18 s_loss: 17.36 kl_loss: 0.70 
[31/50][45]
                  Loss_D: 2.90 Loss_G: 58.19 Time: 38.04s
[32/50][45]
                  Loss_D: 2.40 Loss_G: 70.24 Time: 37.94s
errD0: 0.46 errD1: 0.86 errD2: 0.75 
g_loss0: 8.74 g_loss1: 9.48 g_loss2: 8.84 w_loss: 11.56 s_loss: 17.07 kl_loss: 0.66 
[33/50][45]
                  Loss_D: 3.17 Loss_G: 62.19 Time: 38.00s
[34/50][45]
                  Loss_D: 2.69 Loss_G: 63.78 Time: 38.04s
errD0: 0.68 errD1: 0.84 errD2: 1.08 
g_loss0: 10.57 g_loss1: 3.35 g_loss2: 2.60 w_loss: 12.21 s_loss: 16.13 kl_loss: 0.76 
[35/50][45]
                  Loss_D: 2.21 Loss_G: 68.95 Time: 37.97s
[36/50][45]
                  Loss_D: 2.91 Loss_G: 49.17 Time: 37.90s
errD0: 0.77 errD1: 0.65 errD2: 1.40 
g_loss0: 10.25 g_loss1: 10.54 g_loss2: 9.04 w_loss: 12.80 s_loss: 17.07 kl_loss: 0.67 
[37/50][45]
                  Loss_D: 3.35 Loss_G: 67.99 Time: 37.94s
[38/50][45]
                  Loss_D: 2.18 Loss_G: 59.06 Time: 37.84s
errD0: 1.14 errD1: 0.68 errD2: 0.70 
g_loss0: 9.62 g_loss1: 12.88 g_loss2: 5.44 w_loss: 10.66 s_loss: 17.92 kl_loss: 0.78 
[39/50][45]
                  Loss_D: 2.52 Loss_G: 57.30 Time: 37.92s
[40/50][45]
                  Loss_D: 2.66 Loss_G: 64.77 Time: 37.96s
Save G/Ds models.
[41/50][45]
                  Loss_D: 2.98 Loss_G: 79.22 Time: 38.05s
errD0: 0.45 errD1: 0.37 errD2: 0.94 
g_loss0: 8.66 g_loss1: 9.96 g_loss2: 17.86 w_loss: 12.85 s_loss: 16.83 kl_loss: 0.80 
[42/50][45]
                  Loss_D: 1.52 Loss_G: 66.19 Time: 38.12s
[43/50][45]
                  Loss_D: 1.80 Loss_G: 65.01 Time: 38.09s
errD0: 0.32 errD1: 1.17 errD2: 0.63 
g_loss0: 6.53 g_loss1: 15.64 g_loss2: 4.03 w_loss: 10.94 s_loss: 16.28 kl_loss: 0.86 
[44/50][45]
                  Loss_D: 1.62 Loss_G: 65.81 Time: 37.91s
[45/50][45]
                  Loss_D: 2.54 Loss_G: 66.08 Time: 38.04s
errD0: 1.11 errD1: 0.55 errD2: 0.57 
g_loss0: 15.18 g_loss1: 7.77 g_loss2: 13.48 w_loss: 9.60 s_loss: 15.94 kl_loss: 0.83 
[46/50][45]
                  Loss_D: 1.65 Loss_G: 55.73 Time: 38.20s
[47/50][45]
                  Loss_D: 2.54 Loss_G: 60.87 Time: 37.84s
errD0: 0.33 errD1: 0.31 errD2: 0.57 
g_loss0: 9.54 g_loss1: 10.35 g_loss2: 6.48 w_loss: 8.51 s_loss: 18.30 kl_loss: 0.92 
[48/50][45]
                  Loss_D: 1.38 Loss_G: 54.07 Time: 37.96s
[49/50][45]
                  Loss_D: 4.03 Loss_G: 47.91 Time: 38.28s
Save G/Ds models.
Total time for training: 1980.2158589363098
